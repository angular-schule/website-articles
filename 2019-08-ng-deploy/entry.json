{"slug":"2019-08-ng-deploy","html":"<p><strong>With version 8.3 of the Angular CLI a new command has been released which has the potential to be a game changer. Now, deployments to any target (Firebase, Azure, GitHub pages...) are potentially only one CLI command away. In this article we will show you everything you need to know.</strong> </p>\n<hr>\n\n<p>Table of contents:</p>\n<ul>\n<li><a href=\"/blog/2019-08-ng-deploy#introduction\">Introduction</a></li>\n<li><a href=\"/blog/2019-08-ng-deploy#background\">Background</a></li>\n<li><a href=\"/blog/2019-08-ng-deploy#command-line-call\">Command Line Call</a></li>\n<li><a href=\"/blog/2019-08-ng-deploy#existing-providers\">Existing providers</a></li>\n<li><a href=\"/blog/2019-08-ng-deploy#deploy-to-multiple-targets\">Deploy to multiple targets</a></li>\n<li><a href=\"/blog/2019-08-ng-deploy#how-to-make-your-own-deployment-builder\">How to make your own deployment builder</a></li>\n<li><a href=\"/blog/2019-08-ng-deploy#summary\">Summary</a></li>\n</ul>\n<h2 id=\"introduction\">Introduction</h2>\n<p>In Angular CLI version 8.3 the Angular team <a href=\"https://github.com/angular/angular-cli/pull/15105\">added a CLI command</a> which invokes a so-called <strong>deployment builder</strong> for a project.\nThis enables us to deploy the application to any potential provider or target with just one command: <code>ng deploy</code>.\nThe amount of code added is relatively small, because builders have already been around for a longer time.\nAnother reason is that the CLI itself does not have much to do, but passes the work on to other third-party code instead.\nSo it&#39;s up to the community to breathe life into the command.\nAnd that&#39;s the reason for this article!</p>\n<h2 id=\"background\">Background</h2>\n<p>In fact, the CLI already had this ability for a while.\nAngular CLI allows us to extend the set of functionality by implementing builders and invoking them with <code>ng run [builder-name]</code>.\nThere is a very detailed <a href=\"https://angular.io/guide/cli-builder\">guide about builders</a> provided in the official docs.</p>\n<p>However, until now deploy commands were not made on top of CLI builders.\nThose commands were usually hidden in their own CLI (e.g. <code>firebase deploy</code>) and had nothing to do with the Angular CLI.\nOur own deploy command (<a href=\"https://github.com/angular-schule/angular-cli-ghpages/\">angular-cli-ghpages</a>) was one of them.\nThere was simply no requirement for us to implement a deeper integration into the CLI.</p>\n<p>Up to now, builders have not yet achieved the necessary attention they deserve.\nThe new command <code>ng deploy</code> is designed to change that!</p>\n<ul>\n<li>It runs in the Angular CLI, so it&#39;s clear that an Angular App should be deployed and reasonable defaults can be set accordingly.</li>\n<li>It is called <code>ng deploy</code> instead of the usual <code>ng run [builder-name]</code> which might be confusing otherwise.</li>\n<li>It throws a meaningful message in case there is no deployment builder installed (<code>Cannot find &quot;deploy&quot; target for the specified project. You should add a package that implements deployment capabilities for your favorite platform.</code>).</li>\n<li>It has a very short syntax, because by default it will deploy the default project in the workspace.</li>\n<li><strong>And the most important point:</strong>\nIt is an invitation to the community to standardise deployments under the umbrella of the Angular CLI!</li>\n</ul>\n<h2 id=\"command-line-call\">Command Line Call</h2>\n<p>Let&#39;s take a look at the semantics. How can a deploy builder be triggered?\nAll this is hidden behind the new command which â€“ of course â€“ also has a shorter alias:</p>\n<pre><code class=\"language-bash\"><span class=\"hljs-attribute\">ng</span> deploy<span class=\"hljs-meta\"> [options]</span>\n<span class=\"hljs-attribute\">ng</span> d<span class=\"hljs-meta\"> [options]</span>\n</code></pre>\n<p>Without any further arguments, the CLI will try to execute the deploy builder for the default project of the workspace.</p>\n<p>Since you can also manage several Angular applications (projects) in one workspace, the CLI accepts an optional project name to deploy.\nThe name is used as specified in the <code>angular.json</code> configuration file.</p>\n<pre><code class=\"language-bash\">ng deploy <span class=\"hljs-selector-attr\">[PROJECT_NAME]</span> <span class=\"hljs-selector-attr\">[options]</span>\n</code></pre>\n<p>So if you have created a project by calling <code>ng new your-angular-project</code>, the complete command could be:</p>\n<pre><code class=\"language-bash\">ng deploy your-angular-<span class=\"hljs-keyword\">project</span> \n</code></pre>\n<p>No other options are necessary here for a simple deployment.\nHowever, all supplied command line options will automatically be passed to the deploy builder for the selected project.\nThus, the builder itself can be further configured.</p>\n<h2 id=\"existing-providers\">Existing providers</h2>\n<p>As for now, there is already a good adaptation for <code>ng deploy</code>.\nThe following providers are currently available:</p>\n<ul>\n<li><code>@angular/fire</code> (Deployment to <a href=\"https://firebase.google.com/docs/hosting\">Firebase hosting</a>)</li>\n<li><code>@azure/ng-deploy</code> (Deployment to <a href=\"https://azure.microsoft.com/en-us/\">Azure</a>)</li>\n<li><code>@netlify-builder/deploy</code> (Deployment to <a href=\"https://www.netlify.com/\">Netlify</a>)</li>\n<li><code>@zeit/ng-deploy</code> (Deployment to <a href=\"https://zeit.co/now\">Now</a>)</li>\n<li><code>angular-cli-ghpages</code> (Deployment to <a href=\"https://pages.github.com/\">GitHub pages</a>)</li>\n</ul>\n<p>In the future you should be able to find more providers via the following search:<br><a href=\"https://www.npmjs.com/search?q=ng%20deploy\">https://www.npmjs.com/search?q=ng%20deploy</a></p>\n<p>You can try out those providers by executing the following commands.</p>\n<ol>\n<li><p>Install the latest version of the Angular CLI.</p>\n<pre><code class=\"language-sh\"><span class=\"hljs-built_in\">npm</span> install -g @angular/cli\n</code></pre>\n</li>\n<li><p>Run <code>ng version</code> to make sure you have installed Angular CLI v8.3.0 or greater.</p>\n</li>\n<li><p>If your existing project doesn&#39;t run on Angular CLI v8.3.0 yet, update it using the command:</p>\n<pre><code class=\"language-sh\"><span class=\"hljs-attribute\">ng</span> update <span class=\"hljs-variable\">@angular</span>/cli <span class=\"hljs-variable\">@angular</span>/core\n</code></pre>\n</li>\n<li><p>Add one of the listed providers to your project.</p>\n<pre><code class=\"language-sh\">ng <span class=\"hljs-built_in\">add</span> [provider]\n</code></pre>\n</li>\n<li><p>Deploy your project via:</p>\n<pre><code class=\"language-sh\"><span class=\"hljs-attribute\">ng deploy</span>\n</code></pre>\n</li>\n</ol>\n<p>One example:</p>\n<p><img src=\"https://angular-schule.github.io/website-articles/2019-08-ng-deploy/angular-cli-ghpages-deploy.gif\" alt=\"angular-cli-ghpages-deploy\"></p>\n<h2 id=\"deploy-to-multiple-targets\">Deploy to multiple targets</h2>\n<p>Right now, <code>ng deploy</code> only supports a single deploy target for a project.\nIf we want to deploy a project to more than one provider, it is necessary to rewrite the <code>angular.json</code> file and step back to the old syntax to execute the builder.</p>\n<p>Let&#39;s assume you want to use <code>@angular/fire</code> and <code>angular-cli-ghpages</code> together for one project.\nFirst, you need to install both packages via <code>ng add @angular/fire</code> and <code>ng add angular-cli-ghpages</code>.\nThe last one will override the configuration of the first one.</p>\n<p>Now open the <code>angular.json</code> file and locate the section <code>projects &gt; you-angular-project &gt; architect &gt; deploy</code>.\nThe trick is to create two sections with different names:</p>\n<pre><code class=\"language-json\">{\n  <span class=\"hljs-string\">&quot;projects&quot;</span>: {\n    <span class=\"hljs-string\">&quot;your-angular-project&quot;</span>: {\n      <span class=\"hljs-string\">&quot;architect&quot;</span>: {\n        <span class=\"hljs-string\">&quot;deploy-ghpages&quot;</span>: {\n          <span class=\"hljs-string\">&quot;builder&quot;</span>: <span class=\"hljs-string\">&quot;angular-cli-ghpages:deploy&quot;</span>,\n          <span class=\"hljs-string\">&quot;options&quot;</span>: {}\n        },\n        <span class=\"hljs-string\">&quot;deploy-firebase&quot;</span>: {\n          <span class=\"hljs-string\">&quot;builder&quot;</span>: <span class=\"hljs-string\">&quot;<span class=\"hljs-variable\">@angular</span>/fire:deploy&quot;</span>,\n          <span class=\"hljs-string\">&quot;options&quot;</span>: {}\n        }\n      }\n    }\n  },\n  <span class=\"hljs-string\">&quot;defaultProject&quot;</span>: <span class=\"hljs-string\">&quot;your-angular-project&quot;</span>\n}\n</code></pre>\n<p>You can now call the two builders via the classic approach again with <code>ng run</code>:</p>\n<pre><code class=\"language-bash\">ng <span class=\"hljs-built_in\">run</span> your-angular-project:deploy-ghpages\nng <span class=\"hljs-built_in\">run</span> your-angular-project:deploy-firebase\n</code></pre>\n<h2 id=\"how-to-make-your-own-deployment-builder\">How to make your own deployment builder</h2>\n<p><a href=\"https://github.com/angular-schule/ngx-deploy-starter\"><img src=\"https://angular-schule.github.io/website-articles/2019-08-ng-deploy/ng-deploy-starter-project.jpg\" alt=\"Teaser\"></a></p>\n<p>As a cloud platform provider (or as a fan of that service), you should consider to implement a dedicated deployment builder, too.\nThe spectrum of possibilities is wide: Let&#39;s think about a deployment via FTP, to AWS, to Heroku, to Rackspace etc. â€“ it&#39;s up to YOU to launch the next rocket! ðŸš€</p>\n<p>To make the start a bit smoother, we started a sample project to help on that way.\nThe groundwork of this starter was provided by Minko Gechev&#39;s <a href=\"https://github.com/mgechev/ngx-gh\">ngx-gh project</a>.</p>\n<p>The starter project has the following purposes:</p>\n<ol>\n<li>Promote the adoption of <code>ng deploy</code></li>\n<li>Clarify various questions and standardise the experience of the various builders</li>\n</ol>\n<p><strong>Learn more at\n<a href=\"https://github.com/angular-schule/ngx-deploy-starter\">https://github.com/angular-schule/ngx-deploy-starter</a></strong></p>\n<p>You are free to customise this project according to your needs.\nPlease keep the spirit of Open Source alive and use the MIT or a compatible license.</p>\n<h2 id=\"summary\">Summary</h2>\n<p>With the new deployment command of the Angular CLI, it will be even easier to manage the complete lifecycle of an Angular application with one single tool.\nIn addition to code generation, build, testing and much more, we can now also conveniently deploy to any target like Azure, Firebase or Netlify.\nMore providers should come soon. ðŸš€ If you developed another deployment builder: Please let us know and we&#39;re happy to add it to our list!</p>\n<hr>\n\n<h2 id=\"thank-you\">Thank you</h2>\n<p>Special thanks go to</p>\n<ul>\n<li><a href=\"https://twitter.com/mgechev\">Minko Gechev</a> for guiding me through the new Angular CLI Architect API.</li>\n<li><a href=\"https://twitter.com/fmalcher01\">Ferdinand Malcher</a> for revising this article and discussing things.</li>\n</ul>\n<p><small><strong>Header image:</strong> <a href=\"https://publicdomainclip-art.blogspot.com/2008/11/sts-126-space-shuttle-endeavour-launch.html\">STS-126 Space Shuttle Endeavour Launch</a>. This NASA still image is in the public domain.</small></p>\n","meta":{"title":"All you need to know about `ng deploy`","author":"Johannes Hoppe","mail":"johannes.hoppe@haushoppe-its.de","published":"2019-08-22T00:00:00.000Z","keywords":["Angular","Angular CLI","Deployment","ng deploy","ng-deploy"],"language":"en","thumbnail":"https://angular-schule.github.io/website-articles/2019-08-ng-deploy/space-shuttle.jpg","hidden":false}}
